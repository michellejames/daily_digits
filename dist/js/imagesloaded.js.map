{"version":3,"sources":["imagesloaded.js"],"names":["window","$","jQuery","console","hasConsole","extend","a","b","prop","objToString","Object","prototype","toString","isArray","obj","call","makeArray","ary","length","i","len","push","defineImagesLoaded","EventEmitter","eventie","ImagesLoaded","elem","options","onAlways","document","querySelectorAll","elements","on","getImages","jqDeferred","Deferred","_this","setTimeout","check","images","nodeName","addImage","childElems","j","jLen","img","loadingImage","LoadingImage","checkedCount","hasAnyBroken","complete","onConfirm","image","message","debug","log","progress","isLoaded","emit","notify","eventName","isComplete","jqMethod","fn","imagesLoaded","callback","instance","promise","cache","cached","src","useCached","naturalWidth","undefined","confirm","proxyImage","Image","bind","isConfirmed","handleEvent","event","method","type","onload","unbindProxyEvents","onerror","unbind","define","amd"],"mappings":"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","file":"imagesloaded.js","sourcesContent":["/*!\n * imagesLoaded v3.0.2\n * JavaScript is all like \"You images are done yet or what?\"\n */\n\n( function( window ) {\n\n'use strict';\n\nvar $ = window.jQuery;\nvar console = window.console;\nvar hasConsole = typeof console !== 'undefined';\n\n// -------------------------- helpers -------------------------- //\n\n// extend objects\nfunction extend( a, b ) {\n  for ( var prop in b ) {\n    a[ prop ] = b[ prop ];\n  }\n  return a;\n}\n\nvar objToString = Object.prototype.toString;\nfunction isArray( obj ) {\n  return objToString.call( obj ) === '[object Array]';\n}\n\n// turn element or nodeList into an array\nfunction makeArray( obj ) {\n  var ary = [];\n  if ( isArray( obj ) ) {\n    // use object if already an array\n    ary = obj;\n  } else if ( typeof obj.length === 'number' ) {\n    // convert nodeList to array\n    for ( var i=0, len = obj.length; i < len; i++ ) {\n      ary.push( obj[i] );\n    }\n  } else {\n    // array of single index\n    ary.push( obj );\n  }\n  return ary;\n}\n\n// --------------------------  -------------------------- //\n\nfunction defineImagesLoaded( EventEmitter, eventie ) {\n\n  /**\n   * @param {Array, Element, NodeList, String} elem\n   * @param {Object or Function} options - if function, use as callback\n   * @param {Function} onAlways - callback function\n   */\n  function ImagesLoaded( elem, options, onAlways ) {\n    // coerce ImagesLoaded() without new, to be new ImagesLoaded()\n    if ( !( this instanceof ImagesLoaded ) ) {\n      return new ImagesLoaded( elem, options );\n    }\n    // use elem as selector string\n    if ( typeof elem === 'string' ) {\n      elem = document.querySelectorAll( elem );\n    }\n\n    this.elements = makeArray( elem );\n    this.options = extend( {}, this.options );\n\n    if ( typeof options === 'function' ) {\n      onAlways = options;\n    } else {\n      extend( this.options, options );\n    }\n\n    if ( onAlways ) {\n      this.on( 'always', onAlways );\n    }\n\n    this.getImages();\n\n    if ( $ ) {\n      // add jQuery Deferred object\n      this.jqDeferred = new $.Deferred();\n    }\n\n    // HACK check async to allow time to bind listeners\n    var _this = this;\n    setTimeout( function() {\n      _this.check();\n    });\n  }\n\n  ImagesLoaded.prototype = new EventEmitter();\n\n  ImagesLoaded.prototype.options = {};\n\n  ImagesLoaded.prototype.getImages = function() {\n    this.images = [];\n\n    // filter & find items if we have an item selector\n    for ( var i=0, len = this.elements.length; i < len; i++ ) {\n      var elem = this.elements[i];\n      // filter siblings\n      if ( elem.nodeName === 'IMG' ) {\n        this.addImage( elem );\n      }\n      // find children\n      var childElems = elem.querySelectorAll('img');\n      // concat childElems to filterFound array\n      for ( var j=0, jLen = childElems.length; j < jLen; j++ ) {\n        var img = childElems[j];\n        this.addImage( img );\n      }\n    }\n  };\n\n  /**\n   * @param {Image} img\n   */\n  ImagesLoaded.prototype.addImage = function( img ) {\n    var loadingImage = new LoadingImage( img );\n    this.images.push( loadingImage );\n  };\n\n  ImagesLoaded.prototype.check = function() {\n    var _this = this;\n    var checkedCount = 0;\n    var length = this.images.length;\n    this.hasAnyBroken = false;\n    // complete if no images\n    if ( !length ) {\n      this.complete();\n      return;\n    }\n\n    function onConfirm( image, message ) {\n      if ( _this.options.debug && hasConsole ) {\n        console.log( 'confirm', image, message );\n      }\n\n      _this.progress( image );\n      checkedCount++;\n      if ( checkedCount === length ) {\n        _this.complete();\n      }\n      return true; // bind once\n    }\n\n    for ( var i=0; i < length; i++ ) {\n      var loadingImage = this.images[i];\n      loadingImage.on( 'confirm', onConfirm );\n      loadingImage.check();\n    }\n  };\n\n  ImagesLoaded.prototype.progress = function( image ) {\n    this.hasAnyBroken = this.hasAnyBroken || !image.isLoaded;\n    this.emit( 'progress', this, image );\n    if ( this.jqDeferred ) {\n      this.jqDeferred.notify( this, image );\n    }\n  };\n\n  ImagesLoaded.prototype.complete = function() {\n    var eventName = this.hasAnyBroken ? 'fail' : 'done';\n    this.isComplete = true;\n    this.emit( eventName, this );\n    this.emit( 'always', this );\n    if ( this.jqDeferred ) {\n      var jqMethod = this.hasAnyBroken ? 'reject' : 'resolve';\n      this.jqDeferred[ jqMethod ]( this );\n    }\n  };\n\n  // -------------------------- jquery -------------------------- //\n\n  if ( $ ) {\n    $.fn.imagesLoaded = function( options, callback ) {\n      var instance = new ImagesLoaded( this, options, callback );\n      return instance.jqDeferred.promise( $(this) );\n    };\n  }\n\n\n  // --------------------------  -------------------------- //\n\n  var cache = {};\n\n  function LoadingImage( img ) {\n    this.img = img;\n  }\n\n  LoadingImage.prototype = new EventEmitter();\n\n  LoadingImage.prototype.check = function() {\n    // first check cached any previous images that have same src\n    var cached = cache[ this.img.src ];\n    if ( cached ) {\n      this.useCached( cached );\n      return;\n    }\n    // add this to cache\n    cache[ this.img.src ] = this;\n\n    // If complete is true and browser supports natural sizes,\n    // try to check for image status manually.\n    if ( this.img.complete && this.img.naturalWidth !== undefined ) {\n      // report based on naturalWidth\n      this.confirm( this.img.naturalWidth !== 0, 'naturalWidth' );\n      return;\n    }\n\n    // If none of the checks above matched, simulate loading on detached element.\n    var proxyImage = this.proxyImage = new Image();\n    eventie.bind( proxyImage, 'load', this );\n    eventie.bind( proxyImage, 'error', this );\n    proxyImage.src = this.img.src;\n  };\n\n  LoadingImage.prototype.useCached = function( cached ) {\n    if ( cached.isConfirmed ) {\n      this.confirm( cached.isLoaded, 'cached was confirmed' );\n    } else {\n      var _this = this;\n      cached.on( 'confirm', function( image ) {\n        _this.confirm( image.isLoaded, 'cache emitted confirmed' );\n        return true; // bind once\n      });\n    }\n  };\n\n  LoadingImage.prototype.confirm = function( isLoaded, message ) {\n    this.isConfirmed = true;\n    this.isLoaded = isLoaded;\n    this.emit( 'confirm', this, message );\n  };\n\n  // trigger specified handler for event type\n  LoadingImage.prototype.handleEvent = function( event ) {\n    var method = 'on' + event.type;\n    if ( this[ method ] ) {\n      this[ method ]( event );\n    }\n  };\n\n  LoadingImage.prototype.onload = function() {\n    this.confirm( true, 'onload' );\n    this.unbindProxyEvents();\n  };\n\n  LoadingImage.prototype.onerror = function() {\n    this.confirm( false, 'onerror' );\n    this.unbindProxyEvents();\n  };\n\n  LoadingImage.prototype.unbindProxyEvents = function() {\n    eventie.unbind( this.proxyImage, 'load', this );\n    eventie.unbind( this.proxyImage, 'error', this );\n  };\n\n  // -----  ----- //\n\n  return ImagesLoaded;\n}\n\n// -------------------------- transport -------------------------- //\n\nif ( typeof define === 'function' && define.amd ) {\n  // AMD\n  define( [\n      'eventEmitter',\n      'eventie'\n    ],\n    defineImagesLoaded );\n} else {\n  // browser global\n  window.imagesLoaded = defineImagesLoaded(\n    window.EventEmitter,\n    window.eventie\n  );\n}\n\n})( window );"]}